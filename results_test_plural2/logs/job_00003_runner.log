CMD:
/home/magri/excalibur-tool/.venv/bin/python3 _excalibur_runs/excalibur_run_compare_schwarzschild_vs_flrw.py --mass-msun 10000000000000.0 --radius-mpc 3.0 --distance-mpc 500.0 --integrator leapfrog4 --flrw-grid-N 128 --output-dir _data/output --progress-every 0 --record-every 0 --renormalize-every 0 --n-steps 5000 --steps-per-cell 3.0 --flrw-grid-size-mpc 1000.0 --sampling cone --n-photons 5 --cone-angle-deg 10.0 --static --flrw-local-coords

STDOUT:
[runner] distance_mpc too large for box: clamping D from 500 to 492 Mpc so observer stays inside grid
[runner] Overriding n_steps 5000 -> 378 to match steps_per_cell=3.0 (cell=2.411e+23 m)
[Schwarzschild] photon 1/3 skipped: Non-finite (r,theta,phi) in SchwarzschildMetricFast
[Schwarzschild] skipped 1/3 photons due to numerical failures
-1.0000000019446087 -8.987551769890904e+16 8.987551804845448e+16
-1.0000000019446087 -8.987551769890904e+16 8.98755180484545e+16
-1.0000000019446087 -8.987551769890904e+16 8.98755180484545e+16
FLRW |u_spatial| mean/min/max = 299792458.0 299792458.0 299792458.00000006
expected ~c = 299792458
dlambda [s] = 268039388119658.22 dx per step [m] mean = 8.035618700520833e+22
=== Outputs ===
Schwarzschild -> _data/output/excalibur_run_schwarzschild_M1.0e13_R3.0_mass500_500_500_obs8_500_500_N5_leapfrog4_S378_D500_cone10deg_Mpc.h5
FLRW          -> _data/output/excalibur_run_perturbed_flrw_static_M1.0e13_R3.0_mass500_500_500_obs8_500_500_N5_leapfrog4_S378_static1_D500_cone10deg_local1_Mpc.h5
=== Null-condition rel error (mean / max / std) ===
Schwarzschild init:  5.192e-17 / 1.335e-16 / 5.841e-17
Schwarzschild final: nan / nan / nan
FLRW init:           7.603e-17 / 1.140e-16 / 5.376e-17
FLRW final:          1.229e-09 / 1.916e-09 / 8.500e-10


STDERR:
/home/magri/excalibur-tool/excalibur/photon/photon.py:57: RuntimeWarning: overflow encountered in scalar power
  g_spatial_terms = sum(abs(g[i,i] * self.u[i]**2) for i in range(1, 4))

