CMD:
/home/magri/excalibur-tool/.venv/bin/python3 _postprocessing/analyze_compare_trajectories.py --schwarzschild _data/output/excalibur_run_schwarzschild_M1.0e13_R3.0_mass500_500_500_obs8_500_500_N10_rk4_S252_D500_cone10deg_Mpc.h5 --flrw _data/output/excalibur_run_perturbed_flrw_static_M1.0e13_R3.0_mass500_500_500_obs8_500_500_N10_rk4_S252_static1_D500_cone10deg_local1_Mpc.h5 --csv results_test_steps/per_run/job_00000.csv

STDOUT:
=== Files ===
Schwarzschild: _data/output/excalibur_run_schwarzschild_M1.0e13_R3.0_mass500_500_500_obs8_500_500_N10_rk4_S252_D500_cone10deg_Mpc.h5 (spherical=1)
FLRW:          _data/output/excalibur_run_perturbed_flrw_static_M1.0e13_R3.0_mass500_500_500_obs8_500_500_N10_rk4_S252_static1_D500_cone10deg_local1_Mpc.h5 (spherical=0)
Lens center (from filename): [500, 500, 500] Mpc

=== Meta (FLRW) ===
  cone_angle_deg: 10.0
  dlambda: 402059082179487.3
  integrator: rk4
  mass_kg: 1.98847e+43
  metric: perturbed_flrw
  mode: sequential
  n_photons: 10
  n_steps: 252
  obs_to_lens_distance_m: 1.5428387905e+25
  radius_m: 9.257032743e+22
  renormalize_every: 0
  static: True
  trace_norm: False

=== Trajectory stats (per photon distribution) ===

-- Schwarzschild --
n_records         mean=2 std=0 min=2 p50=2 p90=2 max=2
finite_fraction   mean=0.4286 std=0.175 min=0 p50=0.5 p90=0.5 max=0.5
path_length [m]   mean=2.604e+25 std=1.06e+25 min=0 p50=3.037e+25 p90=3.037e+25 max=3.037e+25
min_r [m]         mean=1.519e+25 std=2.15e+09 min=1.519e+25 p50=1.519e+25 p90=1.519e+25 max=1.519e+25
bend angle [rad]  mean=4.367e-07 std=5.47e-07 min=0 p50=6.144e-08 p90=1.282e-06 max=1.282e-06

-- FLRW --
n_records         mean=2 std=0 min=2 p50=2 p90=2 max=2
finite_fraction   mean=0.5 std=0 min=0.5 p50=0.5 p90=0.5 max=0.5
path_length [m]   mean=3.037e+25 std=1e+16 min=3.037e+25 p50=3.037e+25 p90=3.037e+25 max=3.037e+25
min_r [m]         mean=1.519e+25 std=9.74e+09 min=1.519e+25 p50=1.519e+25 p90=1.519e+25 max=1.519e+25
bend angle [rad]  mean=3.046e-08 std=1.67e-08 min=0 p50=2.98e-08 p90=4.804e-08 max=4.942e-08

=== Direct comparison (FLRW - Schwarzschild) ===
bend angle delta [rad]: mean=-4.062e-07 std=5.346e-07 min=-1.237e-06 max=2.107e-08
bend angle delta [arcsec]: mean=-8.379e-02 std=1.103e-01

Wrote CSV: results_test_steps/per_run/job_00000.csv

=== Theory check: alpha_th = 4GM/(c^2 b), b â‰ˆ min_r ===
Using mass_kg = 1.988470e+43
Schwarzschild (meas - th): n=6 mean=5.056e-07 rad std=5.587e-07 rad min=-3.889e-09 rad p50=2.122e-07 rad p90=1.278e-06 rad max=1.278e-06 rad
FLRW         (meas - th): n=7 mean=2.657e-08 rad std=1.667e-08 rad min=-3.889e-09 rad p50=2.591e-08 rad p90=4.415e-08 rad max=4.553e-08 rad
Schwarzschild (meas - th): n=6 mean=1.043e-01 arcsec std=1.152e-01 arcsec min=-8.022e-04 arcsec p50=4.377e-02 arcsec p90=2.635e-01 arcsec max=2.635e-01 arcsec
FLRW         (meas - th): n=7 mean=5.480e-03 arcsec std=3.438e-03 arcsec min=-8.022e-04 arcsec p50=5.345e-03 arcsec p90=9.107e-03 arcsec max=9.392e-03 arcsec
Schwarzschild (meas/th - 1): n=6 mean=1.300e+02 std=1.436e+02 min=-1.000e+00 p50=5.456e+01 p90=3.285e+02 max=3.285e+02
FLRW         (meas/th - 1): n=7 mean=6.831e+00 std=4.285e+00 min=-1.000e+00 p50=6.663e+00 p90=1.135e+01 max=1.171e+01


STDERR:
/home/magri/excalibur-tool/_postprocessing/analyze_compare_trajectories.py:162: RuntimeWarning: All-NaN slice encountered
  min_r = float(np.nanmin(rr)) if n_records else float("nan")
/home/magri/excalibur-tool/_postprocessing/analyze_compare_trajectories.py:188: RuntimeWarning: Mean of empty slice
  speed_mean = float(np.nanmean(speed))
/home/magri/excalibur-tool/_postprocessing/analyze_compare_trajectories.py:189: RuntimeWarning: All-NaN slice encountered
  speed_max = float(np.nanmax(speed))

